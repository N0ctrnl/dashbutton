# dashbtn
needs arm-linux-gnueabihf- toolchain, lua, sox

Current payload for the exploit is a tiny chunk of code which dumps
the flash and then lets the watchdog expire so the button shuts down
afterwards. The asm source is in flashdump.s.

I assembled it with the gnu assembler arm-none-eabi-as flashdump.s and
dumped it with objdump: arm-none-eabi-objdump -S a.out
Then I copied the opcodes by hand into the lua script flashdump.lua.
This script generates a hex-string from the payload which can be fed
to fsk via stdin. fsk prepends the correct crc and length and outputs
a raw signed int 16 little endian 48kHz audio file. This file can be
played or converted with sox.

play.sh basically does all the necessary things.
just invoke it with the payload asm file as argument.
example: ./play.sh flashdump.s

The led of the button stops fading once the payload is executed and
turns off once the flash dump is complete when the button shut down
due to the expiring watchdog.

The lua script also does another trick: it packs some 32bit words into
the payload so that these words will be on the stack and can be pop'ed
once the code runs. This is done for the uart tx function and some
register locations - e.g. for the watchdog. This trick reduces the
payload size a bit.
